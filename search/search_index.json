{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"The WLCG Virtual Organization An instance of IAM has been deployed in support of WLCG development and integration activities in support of the migration to token-based authentication and authorization. The WLCG IAM instance is integrated with CERN SSO. Registration is active. IAM documentation is available here . Clients applications can be registered following these instructions , or using oidc-agent . VOMS support is enabled. To link an X.509 certificate to an existing IAM WLCG account, follow these instructions . As in VOMS, multiple certificates can be linked to an account. WLCG VO VOMS configuration VOMSES LSC To have a working VOMS configuration for the WLCG VO: place the lsc file in the /etc/grid-security/vomsdir/wlcg directory place the vomses file in the /etc/vomses directory (only needed if you need to do voms-proxy-init ) The latest supported VOMS clients are required (i.e., voms-proxy-init v. >=3 ). Also note that this VO is supported by IAM, i.e. there are no VOMS Admin endpoints that can be used to generate Gridmap files. Example $ voms-proxy-init -voms wlcg Enter GRID pass phrase for this identity: Contacting wlcg-voms.cloud.cnaf.infn.it:15001 [/DC=org/DC=terena/DC=tcs/C=IT/L=Frascati/O=Istituto Nazionale di Fisica Nucleare/CN=voms-wlcg.cloud.cnaf.infn.it] \"wlcg\"... Remote VOMS server contacted succesfully. Created proxy in /tmp/x509up_u501. Your proxy is valid until Thu Jan 30 03:47:58 CET 2020 $ voms-proxy-info -all subject : /DC=org/DC=terena/DC=tcs/C=IT/O=Istituto Nazionale di Fisica Nucleare/CN=Andrea Ceccanti aceccant@infn.it/CN=743668640 issuer : /DC=org/DC=terena/DC=tcs/C=IT/O=Istituto Nazionale di Fisica Nucleare/CN=Andrea Ceccanti aceccant@infn.it identity : /DC=org/DC=terena/DC=tcs/C=IT/O=Istituto Nazionale di Fisica Nucleare/CN=Andrea Ceccanti aceccant@infn.it type : RFC3820 compliant impersonation proxy strength : 1024 path : /tmp/x509up_u501 timeleft : 11:59:55 key usage : Digital Signature, Key Encipherment, Data Encipherment === VO wlcg extension information === VO : wlcg subject : /DC=org/DC=terena/DC=tcs/C=IT/O=Istituto Nazionale di Fisica Nucleare/CN=Andrea Ceccanti aceccant@infn.it issuer : /DC=org/DC=terena/DC=tcs/C=IT/L=Frascati/O=Istituto Nazionale di Fisica Nucleare/CN=wlcg-voms.cloud.cnaf.infn.it attribute : /wlcg attribute : /wlcg/xfers timeleft : 11:59:55 uri : wlcg-voms.cloud.cnaf.infn.it:15001","title":"The WLCG Virtual Organization"},{"location":"#the-wlcg-virtual-organization","text":"An instance of IAM has been deployed in support of WLCG development and integration activities in support of the migration to token-based authentication and authorization. The WLCG IAM instance is integrated with CERN SSO. Registration is active. IAM documentation is available here . Clients applications can be registered following these instructions , or using oidc-agent . VOMS support is enabled. To link an X.509 certificate to an existing IAM WLCG account, follow these instructions . As in VOMS, multiple certificates can be linked to an account.","title":"The WLCG Virtual Organization"},{"location":"#wlcg-vo-voms-configuration","text":"VOMSES LSC To have a working VOMS configuration for the WLCG VO: place the lsc file in the /etc/grid-security/vomsdir/wlcg directory place the vomses file in the /etc/vomses directory (only needed if you need to do voms-proxy-init ) The latest supported VOMS clients are required (i.e., voms-proxy-init v. >=3 ). Also note that this VO is supported by IAM, i.e. there are no VOMS Admin endpoints that can be used to generate Gridmap files.","title":"WLCG VO VOMS configuration"},{"location":"#example","text":"$ voms-proxy-init -voms wlcg Enter GRID pass phrase for this identity: Contacting wlcg-voms.cloud.cnaf.infn.it:15001 [/DC=org/DC=terena/DC=tcs/C=IT/L=Frascati/O=Istituto Nazionale di Fisica Nucleare/CN=voms-wlcg.cloud.cnaf.infn.it] \"wlcg\"... Remote VOMS server contacted succesfully. Created proxy in /tmp/x509up_u501. Your proxy is valid until Thu Jan 30 03:47:58 CET 2020 $ voms-proxy-info -all subject : /DC=org/DC=terena/DC=tcs/C=IT/O=Istituto Nazionale di Fisica Nucleare/CN=Andrea Ceccanti aceccant@infn.it/CN=743668640 issuer : /DC=org/DC=terena/DC=tcs/C=IT/O=Istituto Nazionale di Fisica Nucleare/CN=Andrea Ceccanti aceccant@infn.it identity : /DC=org/DC=terena/DC=tcs/C=IT/O=Istituto Nazionale di Fisica Nucleare/CN=Andrea Ceccanti aceccant@infn.it type : RFC3820 compliant impersonation proxy strength : 1024 path : /tmp/x509up_u501 timeleft : 11:59:55 key usage : Digital Signature, Key Encipherment, Data Encipherment === VO wlcg extension information === VO : wlcg subject : /DC=org/DC=terena/DC=tcs/C=IT/O=Istituto Nazionale di Fisica Nucleare/CN=Andrea Ceccanti aceccant@infn.it issuer : /DC=org/DC=terena/DC=tcs/C=IT/L=Frascati/O=Istituto Nazionale di Fisica Nucleare/CN=wlcg-voms.cloud.cnaf.infn.it attribute : /wlcg attribute : /wlcg/xfers timeleft : 11:59:55 uri : wlcg-voms.cloud.cnaf.infn.it:15001","title":"Example"},{"location":"token-based-authorization/","text":"Token-based authorization Getting an account on the wlcg IAM instance To register in the WLCG IAM instance, point your browser to the wlcg IAM VO page . If you have a CERN account, use that account to login to the wlcg VO. Registering a client in the WLCG IAM instance Getting tokens out IAM Scope-based authorization Group-based authorization Adding audience constraints","title":"Token-based authorization"},{"location":"token-based-authorization/#token-based-authorization","text":"","title":"Token-based authorization"},{"location":"token-based-authorization/#getting-an-account-on-the-wlcg-iam-instance","text":"To register in the WLCG IAM instance, point your browser to the wlcg IAM VO page . If you have a CERN account, use that account to login to the wlcg VO.","title":"Getting an account on the wlcg IAM instance"},{"location":"token-based-authorization/#registering-a-client-in-the-wlcg-iam-instance","text":"","title":"Registering a client in the WLCG IAM instance"},{"location":"token-based-authorization/#getting-tokens-out-iam","text":"","title":"Getting tokens out IAM"},{"location":"token-based-authorization/#scope-based-authorization","text":"","title":"Scope-based authorization"},{"location":"token-based-authorization/#group-based-authorization","text":"","title":"Group-based authorization"},{"location":"token-based-authorization/#adding-audience-constraints","text":"","title":"Adding audience constraints"},{"location":"token-based-authorization/doma-testbed/","text":"DOMA Token-based AuthZ Testbed Endpoints IAM https://wlcg.cloud.cnaf.infn.it RUCIO Install rucio client virtualenv rucio source rucio/bin/activate pip install rucio-clients mkdir rucio/etc cat > rucio/etc/rucio.cfg <<EOF [client] rucio_host = https://rucio-doma.cern.ch:443 auth_host = https://rucio-doma-auth.cern.ch:443 auth_type = x509_proxy # admin credentials #auth_type = userpass #username = ddmlab #password = secret account = root ca_cert = /etc/grid-security/certificates request_retries = 3 EOF Setup rucio client source rucio/bin/activate export RUCIO_HOME=`pwd`/rucio FTS ? dCache Prometheus dev endpoint DPM PRAGUE production endpoint Echo ? EOS ? StoRM CNAF production endpoint CNAF dev endpoint (not yet active) XRootD ?","title":"DOMA Token-based AuthZ Testbed"},{"location":"token-based-authorization/doma-testbed/#doma-token-based-authz-testbed","text":"","title":"DOMA Token-based AuthZ Testbed"},{"location":"token-based-authorization/doma-testbed/#endpoints","text":"","title":"Endpoints"},{"location":"token-based-authorization/doma-testbed/#iam","text":"https://wlcg.cloud.cnaf.infn.it","title":"IAM"},{"location":"token-based-authorization/doma-testbed/#rucio","text":"Install rucio client virtualenv rucio source rucio/bin/activate pip install rucio-clients mkdir rucio/etc cat > rucio/etc/rucio.cfg <<EOF [client] rucio_host = https://rucio-doma.cern.ch:443 auth_host = https://rucio-doma-auth.cern.ch:443 auth_type = x509_proxy # admin credentials #auth_type = userpass #username = ddmlab #password = secret account = root ca_cert = /etc/grid-security/certificates request_retries = 3 EOF Setup rucio client source rucio/bin/activate export RUCIO_HOME=`pwd`/rucio","title":"RUCIO"},{"location":"token-based-authorization/doma-testbed/#fts","text":"?","title":"FTS"},{"location":"token-based-authorization/doma-testbed/#dcache","text":"Prometheus dev endpoint","title":"dCache"},{"location":"token-based-authorization/doma-testbed/#dpm","text":"PRAGUE production endpoint","title":"DPM"},{"location":"token-based-authorization/doma-testbed/#echo","text":"?","title":"Echo"},{"location":"token-based-authorization/doma-testbed/#eos","text":"?","title":"EOS"},{"location":"token-based-authorization/doma-testbed/#storm","text":"CNAF production endpoint CNAF dev endpoint (not yet active)","title":"StoRM"},{"location":"token-based-authorization/doma-testbed/#xrootd","text":"?","title":"XRootD"},{"location":"token-based-authorization/oidc-agent/","text":"OIDC Agent Installation instructions How to register a client How to get a token from oidc-agent Limiting issued scopes Limiting token audience","title":"OIDC Agent"},{"location":"token-based-authorization/oidc-agent/#oidc-agent","text":"","title":"OIDC Agent"},{"location":"token-based-authorization/oidc-agent/#installation-instructions","text":"","title":"Installation instructions"},{"location":"token-based-authorization/oidc-agent/#how-to-register-a-client","text":"","title":"How to register a client"},{"location":"token-based-authorization/oidc-agent/#how-to-get-a-token-from-oidc-agent","text":"","title":"How to get a token from oidc-agent"},{"location":"token-based-authorization/oidc-agent/#limiting-issued-scopes","text":"","title":"Limiting issued scopes"},{"location":"token-based-authorization/oidc-agent/#limiting-token-audience","text":"","title":"Limiting token audience"}]}